CURRENT STATE OF THE SPQSP TNBC CODE

1) Input parameters

In the xml file ".../TNBC/TNBC_sim/resource/param_all.xml", there are sets of input parameters with comments "do not change" or "not used". 
The former refers to predefined parameters for the spQSP algorithm that should not be changed.
The latter refers to parameters that have been included but are not used for the calculations performed in this study. They are necessary for future expansions of the model (spatial variation of species such as CCL2 or Arg-I, 
addition of IL2 and IFNgamma, resection of the tumor, ipilimumab and other treatments, etc.). Some code lines for these future expansions have been also included but the algorithm does not use them for this study.

2) The parameter "Param.ABM.Environment.Tumor.sd_init_norm_dist" in the xml file ".../TNBC/TNBC_sim/resource/param_all.xml" should be estimated from 

a) "Param.QSP.simulation.init_cancer_cell"
b) "Param.ABM.Environment.ScalingFactor"

"Param.ABM.Environment.Tumor.sd_init_norm_dist" should have a value such that the number of cancer cells in ABM at time t=0 should be approximately:

Initial number of CC in ABM ~ Param.QSP.simulation.init_cancer_cell/Param.ABM.Environment.ScalingFactor (Equation 1).

It is recommended to choose an initial estimate of "Param.ABM.Environment.Tumor.sd_init_norm_dist", run the first timesteps of the simulation and verify that Equation 1 holds.
If it does not, repeat the process with a new estimate.

3) This spQSP extended version required to change the following lines in two of the shared code files from Gong's original spatial QSP model (https://github.com/popellab/SPQSP_IO/tree/main/SPQSP_IO/SP_QSP_shared/ABM_Base):

-   SP_QSP_shared/ABM_Base/SpatialCompartment.h

Line 43 -> virtual void timeSlice(unsigned long slice, int cc, int teff, int treg, int mdsc, int texh)= 0;

By adding 'int cc, int teff, int treg, int mdsc, int texh' to the original line, the algorithm uses 'timeSlice' function to use the total number of cells in ABM (cancer cells, effector T cells, regulatory T cells, MDSCs, and exhausted T cells, respectively) at time t to estimate the number of cells at the next time step.
As explained in section 2.3 (QSP-ABM coupling) of the manuscript, the number of cells in ABM is necessary for scaling calculations every time step.

-   SP_QSP_shared/ABM_Base/CellAgent.h

Line 43 -> virtual bool agent_state_step(double t, double dt, Coord& c, int cc_p, int teff_p, int treg_p, int mdsc_p, int texh_p) = 0;

Again, by adding 'int cc_p, int teff_p, int treg_p, int mdsc_p, int texh_p' to the original line, the algorithm uses 'agent_state_step' function to use the total number of cells in ABM (cancer cells, effector T cells, regulatory T cells, MDSCs, and exhausted T cells, respectively) at time t to estimate the number of cells at the next time step.

For any questions, please contact me through my e-mail: alvrm86@gmail.com
